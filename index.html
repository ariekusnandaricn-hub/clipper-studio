<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AO Clipper Mobile</title>
    <style>
        /* --- COLOR PALETTE --- */
        :root { 
            --bg: #000000; 
            --panel: #121212; 
            --border: #2a2a2a; 
            --primary: #00E5FF; 
            --warning: #FFD700;
            --text: #ffffff;
            --secondary-text: #8b8b8b;
            --chat-bg: #1a1a1a;
            --user-bubble: #008899;
            --bot-bubble: #333;
        }

        body { 
            background-color: var(--bg); 
            color: var(--text); 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; 
        }

        /* --- HEADER --- */
        .app-header {
            background: #000;
            padding: 8px 15px;
            display: flex; align-items: center; justify-content: space-between;
            height: 50px; border-bottom: 1px solid var(--border);
            z-index: 100;
        }

        .header-brand { 
            display: flex; align-items: center; gap: 10px; cursor: pointer; padding: 5px;
        }
        .main-logo { height: 32px; width: auto; object-fit: contain; } 
        .header-title { font-size: 1rem; font-weight: 800; letter-spacing: 1px; color: white; display: flex; align-items: center; gap: 5px;}
        .vip-badge { font-size: 0.8rem; display: none; animation: popIn 0.5s; }
        @keyframes popIn { from{transform:scale(0);} to{transform:scale(1);} }

        .btn-export-top {
            background: var(--primary); color: black; border: none;
            padding: 8px 20px; border-radius: 20px; font-weight: 700; font-size: 0.9rem;
            cursor: pointer; text-decoration: none;
        }

        /* --- NOTICE BAR --- */
        .notice-ticker {
            background: rgba(255, 215, 0, 0.15); color: var(--warning);
            font-size: 0.75rem; padding: 8px 0; 
            border-bottom: 1px solid #333; font-weight: 600;
            white-space: nowrap; overflow: hidden; position: relative;
        }
        .ticker-text {
            display: inline-block; padding-left: 100%; animation: marquee 20s linear infinite; 
        }
        @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

        /* --- INPUT --- */
        .input-section {
            background: #080808; padding: 15px; border-bottom: 1px solid #222; display: flex; justify-content: center;
        }
        .input-wrapper {
            width: 100%; max-width: 600px; display: flex; gap: 10px; 
            background: #181818; padding: 5px; border-radius: 50px; border: 1px solid #333;
        }
        .url-input { flex: 1; background: transparent; border: none; color: white; outline: none; font-size: 0.9rem; padding-left: 15px; }
        .btn-load { background: #333; color: white; border: none; padding: 10px 20px; border-radius: 50px; font-size: 0.8rem; font-weight: bold; cursor: pointer; }

        /* --- WORKSPACE --- */
        .workspace { flex: 1; display: flex; flex-direction: column; overflow-y: auto; }
        
        .video-container {
            width: 100%; height: 280px; 
            background: #000; display: flex; align-items: center; justify-content: center;
            border-bottom: 1px solid #222;
            background-image: radial-gradient(circle, #222 1px, transparent 1px);
            background-size: 20px 20px;
        }
        video { width: 100%; height: 100%; object-fit: contain; display: none; }
        video.active { display: block; }

        /* --- CONTROLS --- */
        .controls-area { background: var(--bg); padding: 20px; padding-bottom: 150px; }
        
        .timeline-info { display: flex; justify-content: space-between; color: var(--secondary-text); font-size: 0.8rem; margin-bottom: 15px; font-family: monospace; border-bottom: 1px solid #222; padding-bottom: 10px; }
        .label-text { font-size: 0.7rem; color: #666; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; display: block; }
        
        .format-scroller { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 5px; margin-bottom: 20px; scrollbar-width: none; }
        .format-btn { 
            background: #111; border: 1px solid #333; color: #ccc; 
            padding: 10px 20px; border-radius: 12px; font-size: 0.8rem; white-space: nowrap; flex-shrink: 0; transition: 0.2s;
        }
        .format-btn.active { border-color: var(--primary); color: black; background: var(--primary); font-weight: bold; }

        .manual-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 10px; }
        .input-group input { width: 100%; background: #111; border: 1px solid #333; color: white; padding: 12px; border-radius: 10px; text-align: center; font-family: monospace; font-size: 1rem; box-sizing: border-box; }

        .time-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        .btn-time {
            background: #1f1f1f; color: var(--primary); border: 1px solid #333;
            padding: 10px; border-radius: 8px; font-size: 0.8rem; font-weight: bold; cursor: pointer;
            display: flex; align-items: center; justify-content: center; gap: 5px;
        }
        .btn-time:active { background: #333; }

        .preset-container { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; }
        .btn-preset {
            background: transparent; border: 1px solid #444; color: #aaa;
            padding: 8px 15px; border-radius: 20px; font-size: 0.75rem; cursor: pointer; transition: 0.2s;
        }
        .btn-preset:active { background: #333; color: white; border-color: white; }

        .btn-main-process {
            width: 100%; padding: 18px; 
            background: linear-gradient(90deg, var(--primary), #00b8cc); 
            color: black; border: none; border-radius: 12px; 
            font-weight: 900; font-size: 1.1rem; letter-spacing: 1px;
            cursor: pointer; margin-top: 5px;
            box-shadow: 0 5px 20px rgba(0, 229, 255, 0.3); text-transform: uppercase;
        }
        .btn-main-process:active { transform: scale(0.98); }

        /* BANNER SUPPORTER */
        .premium-banner {
            background: linear-gradient(135deg, #1f1f1f 0%, #000 100%);
            border-radius: 12px; padding: 15px; display: flex; align-items: center; justify-content: space-between;
            margin-top: 35px; border: 1px solid #333;
        }
        .premium-btn { background: #ffe600; color: black; border: none; padding: 8px 15px; border-radius: 6px; font-size: 0.75rem; font-weight: bold; cursor: pointer; }

        /* LEGAL FOOTER */
        .legal-footer { text-align: center; margin-top: 30px; }
        .legal-link { font-size: 0.65rem; color: #555; text-decoration: none; cursor: pointer; transition: 0.2s; border-bottom: 1px dotted #555; }
        .legal-link:hover { color: #888; border-color: #888; }

        /* --- CHATBOT UI --- */
        .chat-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); backdrop-filter: blur(5px);
            z-index: 600; display: none; align-items: flex-end; justify-content: center;
        }
        .chat-widget {
            background: var(--chat-bg); width: 100%; max-width: 500px; height: 80vh;
            border-top-left-radius: 20px; border-top-right-radius: 20px;
            display: flex; flex-direction: column; overflow: hidden;
            box-shadow: 0 -5px 30px rgba(0,0,0,0.5); animation: slideUp 0.3s ease-out;
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        .chat-header {
            padding: 15px; background: #222; border-bottom: 1px solid #333;
            display: flex; align-items: center; justify-content: space-between;
        }
        .bot-profile { display: flex; align-items: center; gap: 10px; }
        .bot-avatar { width: 35px; height: 35px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }
        .bot-name { font-weight: bold; color: white; font-size: 0.9rem; }
        .bot-status { font-size: 0.7rem; color: var(--primary); }
        .btn-close-chat { background: none; border: none; color: #888; font-size: 1.5rem; cursor: pointer; }

        .chat-body {
            flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px;
        }
        .msg { max-width: 80%; padding: 10px 15px; border-radius: 15px; font-size: 0.9rem; line-height: 1.4; animation: fadeIn 0.3s; }
        .msg.bot { align-self: flex-start; background: var(--bot-bubble); color: #ddd; border-bottom-left-radius: 2px; }
        .msg.user { align-self: flex-end; background: var(--user-bubble); color: white; border-bottom-right-radius: 2px; }
        .msg img { width: 100%; border-radius: 10px; margin-top: 5px; border: 2px solid white; }

        .chat-options {
            padding: 15px; background: #222; display: flex; gap: 10px; overflow-x: auto;
        }
        .chat-opt-btn {
            background: transparent; border: 1px solid var(--primary); color: var(--primary);
            padding: 8px 15px; border-radius: 20px; font-size: 0.8rem; white-space: nowrap; cursor: pointer;
        }
        .chat-opt-btn:active { background: var(--primary); color: black; }

        /* MODAL STYLES */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(8px); z-index: 700; align-items: center; justify-content: center; }
        .modal-box { background: #181818; width: 85%; max-width: 350px; border: 1px solid #333; border-radius: 20px; padding: 25px; text-align: center; position: relative;}
        .modal-title { font-size: 1.2rem; font-weight: bold; color: white; margin-bottom: 10px; }
        .modal-desc { font-size: 0.8rem; color: #aaa; margin-bottom: 20px; line-height: 1.5; }
        .modal-input { width: 100%; padding: 15px; background: #000; border: 2px solid #333; color: var(--primary); font-size: 1.2rem; text-align: center; border-radius: 12px; font-weight: bold; outline: none; margin-bottom:15px; box-sizing: border-box;}
        .btn-modal-action { width: 100%; padding: 15px; background: var(--primary); color: black; border: none; border-radius: 12px; font-weight: 800; font-size: 1rem; cursor: pointer; }
        
        .legal-text-area { 
            text-align: left; font-size: 0.7rem; color: #ccc; 
            max-height: 300px; overflow-y: auto; background: #111; 
            padding: 10px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #333;
        }
        .legal-text-area h4 { color: var(--primary); margin: 10px 0 5px 0; }
        
        #status-toast { position: fixed; top: 120px; left: 50%; transform: translateX(-50%); background: rgba(0, 229, 255, 0.9); color: black; padding: 10px 20px; border-radius: 30px; font-size: 0.85rem; font-weight: bold; display: none; z-index: 300; }
    </style>
</head>
<body>

    <div class="app-header">
        <div class="header-brand" onclick="openKeyModal()">
            <img src="logo.png" alt="AO" class="main-logo" onerror="this.style.display='none'">
            <span class="header-title">AO STUDIO <span id="vip-badge" class="vip-badge">üëë</span></span>
        </div>
        <button class="btn-export-top" id="btn-top-export" onclick="processClip()">Export</button>
    </div>

    <div class="notice-ticker">
        <div class="ticker-text">
            ‚ö†Ô∏è BETA MODE: Gratis (Max 2x & 60 Detik) | ‚öñÔ∏è PERSONAL USE ONLY (Gunakan dengan Bijak) | üïí JAM OPERASIONAL: 13.00 - 00.00 WIB
        </div>
    </div>

    <div class="input-section">
        <div class="input-wrapper">
            <input type="text" id="url" class="url-input" placeholder="Paste YouTube Link...">
            <button class="btn-load" onclick="loadVideo()">LOAD</button>
        </div>
    </div>

    <div id="status-toast">Ready</div>

    <div id="modal-key" class="modal-overlay">
        <div class="modal-box" style="border-color: var(--primary);">
            <div class="modal-title" style="color:var(--primary)">üîê SUPPORTER LOGIN</div>
            <div class="modal-desc">Masukkan Kode Akses Supporter Anda.</div>
            <input type="password" id="secret_key_modal" class="modal-input" placeholder="KODE RAHASIA">
            <button class="btn-modal-action" onclick="saveKeyFromModal()">MASUK</button>
            <button style="background:none; border:none; color:#666; margin-top:10px; cursor:pointer;" onclick="closeModal('modal-key')">Tutup</button>
        </div>
    </div>

    <div id="modal-legal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title">‚öñÔ∏è DISCLAIMER</div>
            <div class="legal-text-area">
                <h4>1. Tool Only</h4>
                AO Studio is a video processing tool. We do not host, store, or distribute copyrighted content.
                <h4>2. User Responsibility</h4>
                You are solely responsible for the content you process. You must own the rights or have permission.
                <h4>3. No Commercial Use</h4>
                This tool is for personal use only. Do not use for piracy or commercial gain.
                <h4>4. Donation System</h4>
                Payments are strictly voluntary donations to support server maintenance costs, not a purchase of content.
            </div>
            <button class="btn-modal-action" onclick="closeModal('modal-legal')">SAYA PAHAM</button>
        </div>
    </div>

    <div id="chat-overlay" class="chat-overlay">
        <div class="chat-widget">
            <div class="chat-header">
                <div class="bot-profile">
                    <div class="bot-avatar">ü§ñ</div>
                    <div>
                        <div class="bot-name">AO Assistant</div>
                        <div class="bot-status">‚óè Online</div>
                    </div>
                </div>
                <button class="btn-close-chat" onclick="closeChat()">√ó</button>
            </div>
            <div class="chat-body" id="chat-box"></div>
            <div class="chat-options" id="chat-options">
                <button class="chat-opt-btn" onclick="botReply('support')">ü§ù Dukung Server</button>
                <button class="chat-opt-btn" onclick="botReply('qris')">‚òï Traktir Kopi (QRIS)</button>
                <button class="chat-opt-btn" onclick="botReply('confirm')">‚úÖ Konfirmasi</button>
            </div>
        </div>
    </div>

    <input type="hidden" id="secret_key">

    <div class="workspace">
        <div class="video-container">
            <video id="player" controls playsinline></video>
        </div>

        <div class="controls-area">
            <div class="timeline-info">
                <span id="video-title">No Video Loaded</span>
                <span id="time-display">--:--</span>
            </div>

            <span class="label-text">ASPECT RATIO</span>
            <div class="format-scroller">
                <button class="format-btn active" onclick="selectRatio(this, 'original')">Original</button>
                <button class="format-btn" onclick="selectRatio(this, '9:16')">TikTok/IG (9:16)</button>
                <button class="format-btn" onclick="selectRatio(this, '16:9')">YouTube (16:9)</button>
            </div>

            <span class="label-text">MANUAL TRIM</span>
            <div class="manual-inputs">
                <div class="input-group"><input type="number" id="start_val" placeholder="0.0"></div>
                <div class="input-group"><input type="number" id="end_val" placeholder="0.0"></div>
            </div>

            <div class="time-actions">
                <button class="btn-time" onclick="setFromPlayer('start')">üëÜ SET START</button>
                <button class="btn-time" onclick="setFromPlayer('end')">üëÜ SET END</button>
            </div>

            <div class="preset-container">
                <button class="btn-preset" onclick="addDuration(30)">‚ö° +30s</button>
                <button class="btn-preset" onclick="addDuration(60)">üî• +60s</button>
                <button class="btn-preset" onclick="addDuration(180)">üé• +3m</button>
            </div>

            <button class="btn-main-process" onclick="processClip()">‚úÇÔ∏è POTONG SEKARANG</button>

            <div class="premium-banner">
                <div>
                    <div style="font-weight:bold; font-size:0.9rem; color:white;">üíé Server Supporter</div>
                    <div style="font-size:0.7rem; color:#888;">Bantu server tetap hidup?</div>
                </div>
                <div><button class="premium-btn" onclick="openChat()">TRAKTIR ‚òï</button></div>
            </div>
            
            <div id="dl-area" style="margin-top:20px; text-align:center; display:none;"></div>

            <div class="legal-footer">
                <span class="legal-link" onclick="openLegalModal()">‚öñÔ∏è Disclaimer & Terms of Service</span>
            </div>
        </div>
    </div>

    <script>
        const API = window.location.origin;
        const player = document.getElementById('player');
        let selectedRatio = 'original';

        // --- MODAL SYSTEM ---
        function openKeyModal() { document.getElementById('modal-key').style.display = 'flex'; }
        function openLegalModal() { document.getElementById('modal-legal').style.display = 'flex'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        function saveKeyFromModal() {
            const val = document.getElementById('secret_key_modal').value;
            document.getElementById('secret_key').value = val;
            localStorage.setItem('ao_secret', val);
            if(val) { showToast("üîê Key Saved!"); document.getElementById('vip-badge').style.display = 'inline-block'; } 
            else { showToast("üîì Key Removed"); document.getElementById('vip-badge').style.display = 'none'; }
            closeModal('modal-key');
        }

        // --- CHATBOT (DONATION MODE) ---
        function openChat() {
            document.getElementById('chat-overlay').style.display = 'flex';
            const chatBox = document.getElementById('chat-box');
            if(chatBox.children.length === 0) {
                addBotMsg("Halo Captain! üëã<br>Suka dengan tool ini? Bantu dukung developer yuk agar server tetap online!");
            }
        }
        function closeChat() { document.getElementById('chat-overlay').style.display = 'none'; }
        function addBotMsg(html) { const chatBox = document.getElementById('chat-box'); const div = document.createElement('div'); div.className = 'msg bot'; div.innerHTML = html; chatBox.appendChild(div); chatBox.scrollTop = chatBox.scrollHeight; }
        function addUserMsg(text) { const chatBox = document.getElementById('chat-box'); const div = document.createElement('div'); div.className = 'msg user'; div.innerText = text; chatBox.appendChild(div); chatBox.scrollTop = chatBox.scrollHeight; }
        
        function botReply(type) {
            if(type === 'support') {
                addUserMsg("ü§ù Cara Dukung Server");
                setTimeout(() => { 
                    addBotMsg("AO Studio adalah alat gratis. Tapi server butuh biaya listrik. ‚ö°<br><br>Kamu bisa bantu <b>Traktir Kopi</b> seikhlasnya agar website ini tetap online dan gratis untuk semua! üöÄ"); 
                }, 500);
            } else if (type === 'qris') {
                addUserMsg("‚òï Traktir Kopi (QRIS)");
                setTimeout(() => { 
                    addBotMsg("Terima kasih orang baik! Silakan scan QRIS ini:"); 
                    addBotMsg("<img src='qris.jpg' onclick='window.open(this.src)'> <br> <small>Support: GoPay/Dana/Ovo/BCA</small>"); 
                }, 800);
            } else if (type === 'confirm') {
                addUserMsg("‚úÖ Konfirmasi Donasi");
                setTimeout(() => { 
                    addBotMsg("<b>Terima Kasih Banyak Captain!</b> üôè‚ú®<br><br>Dukunganmu sangat berarti supaya server AO Studio tetap hidup.<br><br>Semoga rejeki Captain makin lancar! Selamat berkarya! üòé"); 
                }, 800);
            }
        }

        // --- CORE FUNCTIONS ---
        function selectRatio(btn, ratio) { document.querySelectorAll('.format-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); selectedRatio = ratio; }
        function showToast(msg) { const t = document.getElementById('status-toast'); t.innerText = msg; t.style.display = 'block'; setTimeout(() => t.style.display='none', 3000); }
        function addDuration(seconds) { let s = parseFloat(document.getElementById('start_val').value) || 0; document.getElementById('end_val').value = (s + seconds).toFixed(1); showToast(`‚è±Ô∏è +${seconds} Detik`); }

        window.onload = function() { const saved = localStorage.getItem('ao_secret'); if(saved) { document.getElementById('secret_key').value = saved; document.getElementById('vip-badge').style.display = 'inline-block'; } }
        async function loadVideo() {
            const url = document.getElementById('url').value; const key = document.getElementById('secret_key').value;
            if(!url) return showToast("‚ùå Link Kosong!");
            showToast("‚è≥ Loading...");
            try {
                const res = await fetch(`${API}/get-stream-url`, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({url, secret_key: key}) });
                const data = await res.json();
                if(data.success) { player.src = data.stream_url; player.classList.add('active'); player.play(); showToast("‚úÖ Loaded!"); if(data.meta) { document.getElementById('video-title').innerText = data.meta.title.substring(0, 25) + '...'; document.getElementById('time-display').innerText = data.meta.duration; } } else { showToast("‚ùå " + data.error); }
            } catch(e) { showToast("‚ùå Connection Error"); }
        }
        function setFromPlayer(type) { const val = player.currentTime.toFixed(1); if(type==='start') { document.getElementById('start_val').value = val; showToast(`üìç Start: ${val}s`); } else { document.getElementById('end_val').value = val; showToast(`üèÅ End: ${val}s`); } }
        async function processClip() {
            const btn = document.querySelector('.btn-main-process'); const originalText = btn.innerText; btn.innerText = "‚è≥ MEMPROSES..."; showToast("‚úÇÔ∏è Processing...");
            const payload = { url: document.getElementById('url').value, start: parseFloat(document.getElementById('start_val').value), end: parseFloat(document.getElementById('end_val').value), ratio: selectedRatio, secret_key: document.getElementById('secret_key').value };
            try {
                const res = await fetch(`${API}/process-clip`, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload) });
                const data = await res.json(); btn.innerText = originalText;
                if(data.success) { showToast("‚úÖ Done!"); const dl = document.getElementById('dl-area'); dl.innerHTML = `<a href="${data.download_url}" target="_blank" style="background:#00E5FF; color:black; padding:15px; border-radius:10px; text-decoration:none; font-weight:bold; display:block; box-shadow:0 0 20px rgba(0,229,255,0.4);">‚¨áÔ∏è DOWNLOAD HASIL</a>`; dl.style.display='block'; dl.scrollIntoView({behavior:"smooth"}); } else { showToast("‚ùå " + data.error); }
            } catch(e) { btn.innerText = originalText; showToast("‚ùå Error"); }
        }
    </script>
</body>
</html>